name: generate bundles

on: [push]

jobs:
  windows:
    name: run on windows
    runs-on: windows-latest
    
    steps:
      - uses: actions/checkout@v4

      - name: Setup VC++
        uses: ilammy/msvc-dev-cmd@v1.4.1
      
      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.11.2'
          cache: 'pip'

      - name: Upgrade pip and enable wheel support
        run: python -m pip install --upgrade pip setuptools wheel 
    
      - uses: suisei-cn/actions-download-file@818d6b7dc8fe73f2f924b6241f2b1134ca1377d9
        id: pyinstaller
        name: Download the file
        with:
          url: "https://github.com/pyinstaller/pyinstaller/archive/refs/tags/v6.9.0.zip"
          target: ./pyinstaller/

      - name: Extract pyinstaller file
        uses: ihiroky/extract-action@v1
        with:
          file_path: ./pyinstaller/v6.9.0.zip
          extract_dir: ./pyinstaller/

      - name: Compile pyinstaller bootloader
        run: |
              cd ./pyinstaller/pyinstaller-6.9.0/
              python3 ./waf distclean all
              python3 setup.py install