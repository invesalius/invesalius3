name: generate bundles

on: [push]

jobs:
  windows:
    name: run on windows
    runs-on: windows-latest
    steps:
      #- run: echo "The job generate bundles was automatically triggered by a ${{ github.event_name }} event."
      #- uses: actions/checkout@v4
      #- uses: ilammy/msvc-dev-cmd@v1.4.1
      
      #- name: Set up Python
      #  uses: actions/setup-python@v5
      #  with:
      #    python-version: '3.11.2'
      #    cache: 'pip'

      #- name: Upgrade pip and enable wheel support
      #  run: python -m pip install --upgrade pip setuptools wheel 
    
      #- name: Install Requirements
      #  run: pip install -r requirements.txt

      - name: file
        run: mkdir pyinstaller

      - uses: suisei-cn/actions-download-file@818d6b7dc8fe73f2f924b6241f2b1134ca1377d9 # 1.6.0
        id: pyinstaller  # Remember to give an ID if you need the output filename
        name: Download the file
        with:
          url: "https://github.com/pyinstaller/pyinstaller/archive/refs/tags/v6.9.0.zip"
          target: ./pyinstaller/

      - name: show
        run: cd pyinstaller

      - name: show 2
        run: dir

      - name: Extract tgz
        uses: ihiroky/extract-action@v1
        with:
          file_path: pyinstaller.zip
          extract_dir: pyinstaller

      - name: Install and generate pyinstaller bootloader
        uses: engineerd/configurator@v0.0.1
        with:                  
          name: "pyinstaller"
          url: "https://github.com/pyinstaller/pyinstaller/archive/refs/tags/v6.9.0.zip"
          pathInArchive: "./pyinstaller/"
        
      - name: Check pyinstaller
        run: cd pyinstaller

      - name: Show files  
        run: dir

      - name: Compile InVesalius Cython parts
        run: python setup.py build_ext --inplace

    #- uses: actions/checkout@v3
    #  with:
    #    repository: 'pyinstaller/pyinstaller'
    #    path: develop
    #    token: ${{ secrets.GITHUB_AUTH_TOKEN }}
    #    run: dir